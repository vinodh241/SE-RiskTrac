<ng-container>
    <mat-toolbar style="background-color: #eae3e3 !important;
    color: #c93e00;">
        <div class="row">
            <div class="incidents-font col-3">{{incidentCount}} <span style="font-size: 20px;">Incidents Found</span>
                <p class="recommendations-font">{{recommedationCount}} Recommendation</p>
            </div>
            <div class="search col-2">
                <input matInput placeholder="  Search Incidents" class="searched-Data" [(ngModel)]="globalSearchValue"
                    (input)="updateTable()">
                <mat-icon matPrefix  class="seacrhIconReport">search</mat-icon>
            </div>
            <div class="col-2" style="padding-left: 35px;">
                <mat-card class="status-card" style="box-shadow: -2px 3px 3px #333333, 10px 1px 0px 1px #F2527D;">
                    <mat-card-header>
                        <span class="status-count" style="color: #F2527D;">{{open}}</span>
                        <span class="status-divider" style="background: #F2527D;"></span>
                        <span class="status-type"><b>Recommendations<br>Open</b></span>
                    </mat-card-header>
                </mat-card>
            </div>
            <div class="col-2" style="padding-left: 10px;">
                <mat-card class="status-card" style="box-shadow: -2px 3px 3px #333333, 10px 1px 0px 1px #ffb26b;">
                    <mat-card-header>
                        <span class="status-count" style="color:#ffb26b">{{claimClosed}}</span>
                        <span class="status-divider" style="background: #ffb26b;"></span>
                        <span class="status-type"><b>Recommendations<br>Claimed Closed</b></span>
                    </mat-card-header>
                </mat-card>
            </div>
            <div class="col-2" style="padding-left: 10px;">
                <mat-card class="status-card" style="box-shadow: -2px 3px 3px #333333, 10px 1px 0px 1px #27ad69;">
                    <mat-card-header>
                        <span class="status-count" style="color:#27ad69">{{closed}}</span>
                        <span class="status-divider" style="background: #27ad69;"></span>
                        <span class="status-type"><b>Recommendations<br>Closed</b></span>
                    </mat-card-header>
                </mat-card>
            </div>
            <!-- <div class="col-1" style="cursor:pointer; padding-left: 30px;" matTooltip="Export to PDF">
                <mat-card class="icon-excel" (click)="generatePdf()">
                    <img class="excel-img" src="assets/icon-pdf.svg" />
                </mat-card>
            </div> -->
            <div class="col-1" style="cursor:pointer;" matTooltip="Export to Excel">
                <mat-card class="icon-excel" (click)="generateExcel()">
                    <img class="excel-img" src="assets/icon-excel.svg" alt="Excel Icon" style="height: 4vh;
                    width: 4vh;
                    margin-top: -1vh;
                    margin-bottom: -1vh;
                    margin-left: 0.1vh;
                    margin-right: 1vh;" />
                </mat-card>
            </div>

        </div>
    </mat-toolbar>
    <div class="mat-elevation-z8">
        <mat-card style="min-height: 557px;">
            <div style="max-height: 71vh;overflow-y:scroll" >
                <table mat-table [dataSource]="dataSource.data" matSort id="incidentTable">
                    <ng-container matColumnDef="SNo">
                        <th mat-header-cell *matHeaderCellDef> # </th>
                        <td mat-cell *matCellDef="let row; let i = index;"> {{i+1}} </td>
                    </ng-container>
                    <ng-container matColumnDef="incidentCode">
                        <th mat-header-cell *matHeaderCellDef> Incident Code </th>
                        <td mat-cell *matCellDef="let row;"> {{row.IncidentCode}} </td>
                    </ng-container>
                    <ng-container matColumnDef="incidentTitle">
                        <th mat-header-cell *matHeaderCellDef> Incident Title </th>
                        <td mat-cell *matCellDef="let row;" [matTooltip]="row.IncidentTitle"> {{row.IncidentTitle}}
                        </td>
                    </ng-container>

                    <ng-container matColumnDef="reportingDate">
                        <th mat-header-cell *matHeaderCellDef> Reporting Date </th>
                        <td mat-cell *matCellDef="let row;"> {{utilsService.formatDate(row.CreatedDate)}} </td>
                    </ng-container>
                    <ng-container matColumnDef="incidentDate">
                        <th mat-header-cell *matHeaderCellDef> Incident Date </th>
                        <td mat-cell *matCellDef="let row;"> {{utilsService.formatDate(row.IncidentDate)}} </td>
                    </ng-container>
                    <ng-container matColumnDef="incidentType">
                        <th mat-header-cell *matHeaderCellDef> Incident Type </th>
                        <td mat-cell *matCellDef="let row;"> {{row.IncidentType}} </td>
                    </ng-container>
                    <ng-container matColumnDef="incidentUnit">
                        <th mat-header-cell *matHeaderCellDef> Incident Unit </th>
                        <td mat-cell *matCellDef="let row;"> {{row.IncidentUnitName}} </td>
                    </ng-container>
                    <ng-container matColumnDef="criticality">
                        <th mat-header-cell *matHeaderCellDef> Criticality </th>
                        <td mat-cell *matCellDef="let row;"> {{row.CriticalityName}} </td>
                    </ng-container>
                    <ng-container matColumnDef="incidentStatus">
                        <th mat-header-cell *matHeaderCellDef> Incident Status </th>
                        <td mat-cell *matCellDef="let row;"> {{row.StatusName}} </td>
                    </ng-container>
                    <ng-container matColumnDef="recommendations">
                        <th mat-header-cell *matHeaderCellDef> Recommendations </th>
                        <td mat-cell *matCellDef="let row;"> {{row.NoOfRecommendations??0}} </td>
                    </ng-container>
                    <ng-container matColumnDef="open">
                        <th mat-header-cell *matHeaderCellDef> open </th>
                        <td mat-cell *matCellDef="let row;"> {{row.NoOfOpen??0}} </td>
                    </ng-container>
                    <ng-container matColumnDef="claimedClosed">
                        <th mat-header-cell *matHeaderCellDef> Claimed Closed </th>
                        <td mat-cell *matCellDef="let row;"> {{row.NoOfClaimClosed??0}} </td>
                    </ng-container>
                    <ng-container matColumnDef="closed">
                        <th mat-header-cell *matHeaderCellDef> Closed </th>
                        <td mat-cell *matCellDef="let row;"> {{row.NoOfClosed??0}} </td>
                    </ng-container>
                    <tr mat-header-row *matHeaderRowDef="displayedColumns; sticky"></tr>
                    <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
                    <tr *matNoDataRow><td [attr.colspan]="displayedColumns.length"><span style="font-size: large;margin-left: 33vw;">No data found.</span></td></tr>
                </table>
            </div>
            <ng-template #noDataTemplate>
                <p class="no-data">No Data Found</p>
            </ng-template>
        </mat-card>
    </div>
</ng-container>
