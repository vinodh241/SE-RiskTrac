<mat-toolbar class="mat-tool-bar"  >
    {{data.title}}
    <button mat-icon-button title="Close" cdkFocusInitial mat-dialog-close>
        <mat-icon aria-hidden="false" aria-label="Close" fontIcon="close"></mat-icon>
    </button>
</mat-toolbar>
<div class="mat-table-padding">

    <table mat-table [dataSource]="listdata" class="my-table">
        <tr mat-header-row
                *matHeaderRowDef="displayedHeaderOneColumns; sticky: true">
        </tr>
        <tr mat-header-row
                *matHeaderRowDef="displayedHeaderTwoColumns; sticky: true">
        </tr>
        <tr mat-row
                *matRowDef="let row; let i = index; columns: displayedColumns" [ngStyle]="{ 'background-color': getBackgroundColor(i) }">
        </tr>



            <ng-container matColumnDef="Sno">
        <th mat-header-cell class="fw-bold fs-6" style="background-color: #d9e1ec;;letter-spacing: 1px;vertical-align: baseline;
        padding: 10px 0px;"
                    *matHeaderCellDef [attr.rowspan]="2">
        </th>
        <td mat-cell style="vertical-align: baseline;
        padding: 12px;padding-left: 10px;padding-right: 15px;" *matCellDef="let element;  let i = index" [attr.rowspan]=" getRowSpan('GroupName',i)" [style.display]="getRowSpan('GroupName', i) ? '' : 'none'">
            {{ getRowSerialNumber(i) }}
          </td>
        </ng-container>



            <ng-container matColumnDef="Group">
                <th mat-header-cell class="fw-bold fs-6 " style="background-color:  #d9e1ec;;letter-spacing: 1px;vertical-align: baseline;
                padding: 10px 0px;"
                    *matHeaderCellDef [attr.rowspan]="2">
                    Group</th>
                <td style="vertical-align: baseline;
                padding-top: 12px;"  mat-cell *matCellDef="let element; let i = index" class="align-left-right "
                        [attr.rowspan]=" getRowSpan('GroupName',i)" [style.display]="getRowSpan('GroupName', i) ? '' : 'none'"  >
                        <div style="display:flex;justify-content: space-between;align-items: center;">
                            <span class="link">{{element.GroupName}} </span>
                            <span class="" style="margin-right: 10px;margin-left: 10px;">{{getRowSpanData(element.GroupName)?.length}}</span>
                        </div>
                </td>
        </ng-container>
        <ng-container matColumnDef="Unit">
        <th mat-header-cell class="fw-bold fs-6" style="background-color:  #d9e1ec;;letter-spacing: 1px;vertical-align: baseline;
        padding: 10px 0px;"
                    *matHeaderCellDef [attr.rowspan]="2">
                    Unit</th>
        <td  mat-cell *matCellDef="let element">{{element.Units}}</td  >
        </ng-container>



            <ng-container matColumnDef="Overhall Inherent Risk Rating">
        <th mat-header-cell class="text-center fs-6 fw-bold  "
                    style=" background-color:  #d9e1ec;color:#1f82a6;letter-spacing: 1px;" *matHeaderCellDef [attr.colspan]="3">
        <span class="text-dark">Overall</span> <span> Inherent Risk</span>
        <br> Rating
        </th>
        </ng-container>
        <ng-container matColumnDef="OverAll Control Enviorment Rating">
        <th mat-header-cell class="text-center fw-bold fs-6"
                    style="background-color:  #d9e1ec; color:#1f82a6;letter-spacing: 1px;" *matHeaderCellDef [attr.colspan]="3">
        <span class="text-dark">Overall</span> <span> Control
                        Enviorment</span> <br> Rating </th>
        </ng-container>
        <ng-container matColumnDef="Residul Risk Rating">
        <th mat-header-cell class="text-center fs-6 fw-bold  "
                    style="background-color:  #d9e1ec; color:#1f82a6;letter-spacing: 1px;" *matHeaderCellDef [attr.colspan]="3">
                    Residul Risk Rating</th>
        </ng-container>



            <ng-container matColumnDef="High">
        <th mat-header-cell class="fw-bold text-center text-uppercase border"
                    style="background-color: rgb(221 143 143);color: #B10000;;letter-spacing: 1px;font-size: 1.6vh;" *matHeaderCellDef>High</th>
        <td class="text-center"  mat-cell *matCellDef="let element">{{element.inherit.high?.length}}</td  >
        </ng-container>



            <ng-container matColumnDef="Moderate">
        <th mat-header-cell class="text-center fw-bold text-uppercase border"
                    style="background-color: rgb(255 191 145);color: #FF6E05;;letter-spacing: 1px;font-size: 1.6vh;" *matHeaderCellDef>Moderate</th>
        <td class="text-center"  mat-cell *matCellDef="let element">{{element.inherit.moderate?.length}}</td  >
        </ng-container>



            <ng-container matColumnDef="Low">
        <th mat-header-cell class="text-center fw-bold text-uppercase border "
                    style="background-color: rgb(148 211 173);color: #0B9A45;;letter-spacing: 1px;font-size: 1.6vh;" *matHeaderCellDef>Low</th>
        <td class="text-center"  mat-cell *matCellDef="let element">{{element.inherit.low?.length}}</td  >
        </ng-container>



            <ng-container matColumnDef="Ineffective">
        <th mat-header-cell class="fw-bold text-center text-uppercase border"
                    style="background-color: rgb(221 143 143);color: #B10000;letter-spacing: 1px;font-size: 1.6vh;" *matHeaderCellDef>Ineffective</th>
        <td class="text-center"  mat-cell *matCellDef="let element">{{element.control.high?.length}}</td  >
        </ng-container>



            <ng-container matColumnDef="Partially Ineffective">
        <th mat-header-cell class="text-center fw-bold text-uppercase border"
                    style="background-color: rgb(255 191 145);color: #FF6E05;letter-spacing: 1px;font-size: 1.6vh;" *matHeaderCellDef>Partially <br>
                    Effective</th>
        <td class="text-center"  mat-cell *matCellDef="let element">{{element.control.moderate?.length}}</td  >
        </ng-container>



            <ng-container matColumnDef="Effective">
        <th mat-header-cell class="text-center fw-bold text-uppercase border "
                    style="background-color: rgb(148 211 173);color: #0B9A45;letter-spacing: 1px;font-size: 1.6vh;" *matHeaderCellDef>Effective</th>
        <td class="text-center"  mat-cell *matCellDef="let element">{{element.control.low?.length}}</td  >
        </ng-container>

        <ng-container matColumnDef="HighRes">
        <th mat-header-cell class="fw-bold text-center text-uppercase border"
                    style="background-color: rgb(221 143 143);color: #B10000;letter-spacing: 1px;font-size: 1.6vh;" *matHeaderCellDef>High</th>
        <td class="text-center"  mat-cell *matCellDef="let element">{{element.residual.high?.length}}</td  >
        </ng-container>



            <ng-container matColumnDef="ModerateRes">
        <th mat-header-cell class="text-center fw-bold text-uppercase border"
                    style="background-color: rgb(255 191 145);color: #FF6E05;letter-spacing: 1px;font-size: 1.6vh;" *matHeaderCellDef>Moderate</th>
        <td class="text-center"  mat-cell *matCellDef="let element">{{element.residual.moderate?.length}}</td  >
        </ng-container>



            <ng-container matColumnDef="LowRes">
        <th mat-header-cell class="text-center fw-bold text-uppercase border "
                    style="background-color: rgb(148 211 173);color: #0B9A45;letter-spacing: 1px;font-size: 1.6vh;" *matHeaderCellDef>Low</th>
        <td class="text-center"  mat-cell *matCellDef="let element">{{element.residual.low?.length}}</td  >
        </ng-container>
        </table>

</div>

<!-- <div class="bottom-dig"> -->
    <button type="button" class="btn btn-secondary modalCancelBtn" id="cancel" style="    margin-bottom: 3vh;
    margin-left: 129vh;" mat-dialog-close>Cancel</button>
    <!-- <button mat-stroked-button mat-dialog-close>Cancel</button> -->
<!-- </div> -->

