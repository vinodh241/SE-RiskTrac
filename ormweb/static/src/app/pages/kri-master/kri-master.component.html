<mat-toolbar class="fontSize">
    <span mat-dialog-title style="font-size: 3.5vh;font-weight: 400;">Key Risk Indicator | Master Setting</span>
    <span class="spacer"></span>
</mat-toolbar>
<div class="container">
    <div class="left">
        <mat-card class="paddingZero"
            style="background: #E3E3E3 url(./assets/rcsa/rd-left-img.png) no-repeat center bottom">
            <div>
                <div>
                    <button class="leftMenuButtons" [ngClass]="isActive('measurement') ? 'active' : ''"
                        (click)="openMenu('measurement')">
                        <h4><strong>Measurement Frequency</strong></h4>
                    </button>
                </div>
                <div>
                    <button class="leftMenuButtons" [ngClass]="isActive('kriType') ? 'active' : 'kriType'"
                        (click)="openMenu('kriType')">
                        <h4><strong>KRI Type</strong></h4>
                    </button>
                </div>
                <div>
                    <button class="leftMenuButtons" [ngClass]="isActive('kriReviwer') ? 'active' : 'kriType'"
                        (click)="openMenu('kriReviwer')">
                        <h4><strong>KRI Reviewer</strong></h4>
                    </button>
                </div>
                <div>
                    <button class="leftMenuButtons" [ngClass]="isActive('frequency') ? 'active' : ''"
                        (click)="openMenu('frequency')">
                        <h4><strong>Reporting Frequency</strong></h4>
                    </button>
                </div>
                <div>
                    <button class="leftMenuButtons" [ngClass]="isActive('status') ? 'active' : ''"
                        (click)="openMenu('status')">
                        <h4><strong>Status</strong></h4>
                    </button>
                </div>
                <div>
                    <button class="leftMenuButtons" [ngClass]="isActive('thresholdValue') ? 'active' : ''"
                        (click)="openMenu('thresholdValue')">
                        <h4><strong>Threshold Value</strong></h4>
                    </button>
                </div>
                <div>
                    <button class="leftMenuButtons" [ngClass]="isActive('emailTrigger') ? 'active' : ''"
                        (click)="openMenu('emailTrigger')">
                        <h4><strong>Email Trigger</strong></h4>
                    </button>
                </div>
            </div>
        </mat-card>
    </div>
    <div class="kri-table" *ngIf="isActive('measurement')">
        <div class="table-header">
            <span> <b> Measurement Frequency </b> </span>
            <span class="spacer"></span>
        </div>
        <div class="mat-elevation-z8 border-radius" style="height: 72vh;">
            <mat-table [dataSource]="service.masterMF" class="border-radius" style="min-height: 72vh;">
                <ng-container matColumnDef="Index">
                    <mat-header-cell *matHeaderCellDef>#</mat-header-cell>
                    <mat-cell *matCellDef="let row"> {{row.Index}} </mat-cell>
                </ng-container>
                <ng-container matColumnDef="Name">
                    <mat-header-cell *matHeaderCellDef>Measurement Frequency</mat-header-cell>
                    <mat-cell *matCellDef="let row">
                        <span [ngClass]="row.IsActive? '':'disable-color'" *ngIf="!row.EditMode">
                            {{row.Name}}
                        </span>
                    </mat-cell>
                </ng-container>
                <ng-container matColumnDef="Period">
                    <mat-header-cell *matHeaderCellDef>Monthly Period</mat-header-cell>
                    <mat-cell *matCellDef="let row">
                        <span [ngClass]="row.IsActive? '':'disable-color'" *ngIf="!row.EditMode">
                            {{row.Description}}
                        </span>
                    </mat-cell>
                </ng-container>
                <ng-container matColumnDef="Status">
                    <mat-header-cell *matHeaderCellDef> Status Enabled/ <br>Disabled</mat-header-cell>
                    <mat-cell *matCellDef="let row">
                        <mat-slide-toggle
                            [disabled]="flag >= 1 || (row.IsActive && service.measurementFreqLength <= 1)? true: false"
                            [(ngModel)]="row.IsActive" name="status"
                            [checked]="row.IsActive == null? false: row.IsActive"
                            (change)="approve(row, 'MeasureFreq')">
                        </mat-slide-toggle> &nbsp; <span>{{(row.IsActive)? 'Enabled': 'Disabled'}}</span>
                    </mat-cell>
                </ng-container>
                <mat-header-row *matHeaderRowDef="displayedColumns2; sticky: true"></mat-header-row>
                <mat-row *matRowDef="let row; columns: displayedColumns2; let i = index"
                    [ngClass]="(i%2 == 0)? 'odd-row-bg':''"></mat-row>
            </mat-table>
        </div>
    </div>
    <div class="kri-table" *ngIf="isActive('kriType')">
        <div class="table-header">
            <span> <b>KRI Type</b> </span>
            <span class="spacer"></span>
            <!-- <mat-form-field appearance="standard">
                <mat-label>Search</mat-label>
                <input matInput (keyup)="applyFilter($event, 'KriType')" placeholder="" #input>
            </mat-form-field> -->
            <!-- <img src="assets/icon-search.svg" class="search-icon" /> -->
        </div>
        <div class="mat-elevation-z8 border-radius" style="height: 73vh;">
            <mat-table [dataSource]="service.masterKT" class="border-radius-top"
                style="max-height: 41.5vh;min-height: 66.5vh;">
                <ng-container matColumnDef="Index">
                    <mat-header-cell *matHeaderCellDef>#</mat-header-cell>
                    <mat-cell *matCellDef="let row"> {{row.Index}} </mat-cell>
                </ng-container>
                <ng-container matColumnDef="Name">
                    <mat-header-cell *matHeaderCellDef>KRI Type</mat-header-cell>
                    <mat-cell *matCellDef="let row">
                        <span [ngClass]="row.IsActive? '':'disable-color'" *ngIf="!row.EditMode">
                            {{row.Name}}
                        </span>
                        <div *ngIf="row.EditMode">
                            <mat-form-field class="name-input">
                                <input matInput [value]="row.Name" [(ngModel)]="row.Name" name="type" type="text"
                                    (keyup)="checkDuplicate(row.Name, 'KriType')">
                            </mat-form-field>
                        </div>
                    </mat-cell>
                </ng-container>
                <ng-container matColumnDef="StatusType">
                    <mat-header-cell *matHeaderCellDef> Status Enabled/ <br>Disabled</mat-header-cell>
                    <mat-cell *matCellDef="let row">
                        <mat-slide-toggle
                            [disabled]="flag >= 1 || (row.IsActive && service.kriTypeLength <= 1)? true: false"
                            [(ngModel)]="row.IsActive" name="status"
                            [checked]="row.IsActive == null? false: row.IsActive" (change)="approve(row, 'KriType')">
                        </mat-slide-toggle> &nbsp; <span>{{(row.IsActive)? 'Enabled': 'Disabled'}}</span>
                    </mat-cell>
                </ng-container>

                <ng-container matColumnDef="Action">
                    <mat-header-cell *matHeaderCellDef>Action</mat-header-cell>
                    <mat-cell *matCellDef="let row">
                        <button *ngIf="!row.EditMode" mat-icon-button (click)="edit(row, 'KriType')">
                            <mat-icon aria-hidden="false" aria-label="Edit" fontIcon="edit"></mat-icon>
                        </button>
                        <mat-action-row *ngIf="row.EditMode" [matTooltip]="duplicate? 'Record already exists':''">
                            <button mat-icon-button title="Done" class="select" matSuffix
                                (click)="approve(row, 'KriType')" [disabled]="row.Name.trim().length == 0 || duplicate">
                                <mat-icon aria-hidden="true" aria-label="done" fontIcon="done"></mat-icon>
                            </button>
                            <button mat-icon-button title="Close" class="cancel" matSuffix cdkFocusInitial
                                (click)="reject(row)">
                                <mat-icon aria-hidden="false" aria-label="Close" fontIcon="close"></mat-icon>
                            </button>
                        </mat-action-row>
                    </mat-cell>
                </ng-container>
               
                <mat-header-row *matHeaderRowDef="displayedColumns; sticky: true"></mat-header-row>
                <mat-row *matRowDef="let row; columns: displayedColumns; let i = index"
                    [ngClass]="(i%2 == 0)? 'odd-row-bg':''"></mat-row>
            </mat-table>
            <div style=" background-color: white;" class="border-radius-bottom">
                <div *ngIf="newEditKT" class="form-style">
                    <label for="type" style="margin-top:1.5vh;">KRI Type:</label>
                    <mat-form-field class="name-input">
                        <input matInput [value]="newName" id="type" [(ngModel)]="newName" name="type" type="text"
                            (keyup)="checkDuplicate(newName, 'KriType')">
                    </mat-form-field>
                    <mat-action-row style="padding-left: 0.5vw" [matTooltip]="duplicate? 'Record already exists':''">
                        <button mat-icon-button title="Done" class="select" matSuffix
                            [disabled]="newName.trim().length == 0 || duplicate" (click)="newDataApprove('KriType')">
                            <mat-icon aria-hidden="true" aria-label="done" fontIcon="done"></mat-icon>
                        </button>
                        <button mat-icon-button title="Close" class="cancel" matSuffix (click)="newDataReject()"
                            cdkFocusInitial>
                            <mat-icon aria-hidden="false" aria-label="Close" fontIcon="close"></mat-icon>
                        </button>
                    </mat-action-row>
                </div>
                <div *ngIf="!newEditKT" class="add-button">
                    <button mat-icon-button (click)="addRow('KriType')">
                        <mat-icon class="add-icon" aria-hidden="false" aria-label="Add" fontIcon="add"></mat-icon>
                    </button>
                </div>
            </div>
        </div>
    </div>
    <div class="kri-table" *ngIf="isActive('kriReviwer')">
        <div class="table-header">
            <span> <b>KRI Reviewer</b> </span>
            <span class="spacer"></span>
        </div>
        <div class="mat-elevation-z8 border-radius" matTooltipPosition="above"
            [matTooltip]="(service.isMasterReviwersActive && service.isMasterReviwerAssigned)? 'No Active Reviewer Users' : ''" >
            <mat-table [dataSource]="service.masterKR" class="border-radius-top" style="    min-height: 62vh;">
                <ng-container matColumnDef="UserIndex" >
                    <mat-header-cell *matHeaderCellDef>#</mat-header-cell>
                    <mat-cell *matCellDef="let row"> {{row.Index}} </mat-cell>
                </ng-container>
                <ng-container matColumnDef="FullName">
                    <mat-header-cell *matHeaderCellDef>Name</mat-header-cell>
                    <mat-cell *matCellDef="let row">
                        <span [ngClass]="row.IsActive? '':'disable-color'" *ngIf="!row.EditMode"  [matTooltip]="row.IsDeleted ? 'Your Risk Management access has been removed in User Management' : ''">
                            {{row.FullName}}
                        </span>
                    </mat-cell>
                </ng-container>
                <ng-container matColumnDef="IsActive">
                    <mat-header-cell *matHeaderCellDef> Status Enabled / <br>Disabled</mat-header-cell>
                    <mat-cell *matCellDef="let row">
                        <!-- <mat-slide-toggle [disabled]="flag >= 1 || !isUserExists(row, 'KRIReviewers') || row.IsDeleted == true"
                            [(ngModel)]="row.IsActive" name="status"
                            [checked]="row.IsActive == null? false: row.IsActive"
                            (change)="approve(row, 'KRIReviewers')"
                            [matTooltip]="row.IsDeleted ? 'Your Risk Management access has been removed in User Management' : ''">
                        </mat-slide-toggle> &nbsp; <span>{{(row.IsActive == null? false: row.IsActive)? 'Enabled':
                            'Disabled'}}</span> -->

                            <mat-slide-toggle
                            [disabled]="row.IsDeleted == true"
                            [(ngModel)]="row.IsActive" name="status"
                            [checked]="row.IsActive == null? false: row.IsActive" (change)="approve(row, 'KRIReviewers')"
                            [matTooltip]="row.IsDeleted ? 'Your Risk Management access has been removed in User Management' : ''">
                        </mat-slide-toggle> &nbsp; <span>{{(row.IsActive)? 'Enabled': 'Disabled'}}</span>
                    </mat-cell>
                </ng-container>
                <mat-header-row *matHeaderRowDef="displayedColumns3; sticky: true"></mat-header-row>
                <mat-row *matRowDef="let row; columns: displayedColumns3; let i = index"
                    [ngClass]="(i%2 == 0)? 'odd-row-bg':''"></mat-row>
            </mat-table>
            <div style="background-color: white;" *ngIf="!(service.isMasterReviwerAssigned)">
                <div class="no-data">
                    <span>No Reviewer user added yet</span>
                </div>
            </div>
            <div class="border-radius-bottom" style=" background-color: white; padding-top: 4vh;">
                <div *ngIf="newEditKF" class="form-style border-radius-bottom">
                    <label for="Reviewers" style="margin-top: 1.5vh;">Select Reviewer:</label>
                    <mat-form-field style="margin: -2vh 0.5vw;">
                        <mat-select matSelectSearch placeholder="Search reviewer..." id="Reviewers" [(ngModel)]="selectedUser" name="user">
                            <mat-option *ngFor="let user of service.masterReviewersAvl" [value]="user.FullName">
                                {{user.FullName}}
                            </mat-option>
                        </mat-select>
                    </mat-form-field>
                    <mat-action-row>
                        <button mat-icon-button title="Done" class="select" matSuffix [disabled]="!selectedUser"
                            (click)="newDataApprove('KRIReviewers')">
                            <mat-icon aria-hidden="true" aria-label="done" fontIcon="done"></mat-icon>
                        </button>
                        <button mat-icon-button title="Close" class="cancel" matSuffix cdkFocusInitial
                            (click)="newDataReject()">
                            <mat-icon aria-hidden="false" aria-label="Close" fontIcon="close"></mat-icon>
                        </button>
                    </mat-action-row>
                </div>
                <div *ngIf="!newEditKF" class="add-button border-radius-bottom">
                    <button mat-icon-button (click)="addRow('KRIReviewers')">
                        <mat-icon class="add-icon" aria-hidden="false" aria-label="Add" fontIcon="add"></mat-icon>
                    </button>
                </div>
            </div>
            <!-- <mat-paginator #paginatorIR [pageSizeOptions]="[10, 25, 100]"></mat-paginator> -->
        </div>
    </div>

    <div class="kri-table" *ngIf="isActive('frequency')">
        <div class="table-header">
            <span><b>Reporting Frequency</b></span>
            <span class="spacer"></span>
        </div>
        <div class="mat-elevation-z8 border-radius">
            <mat-table [dataSource]="service.masterRF" class="border-radius" style="min-height: 36vh;">
              
                <ng-container matColumnDef="Index">
                    <mat-header-cell *matHeaderCellDef>#</mat-header-cell>
                    <mat-cell *matCellDef="let row"> {{row.Index}} </mat-cell>
                </ng-container>

                <!-- Reporting Frequency column -->
                <ng-container matColumnDef="Name">
                <mat-header-cell *matHeaderCellDef>Reporting Frequency</mat-header-cell>
                <mat-cell *matCellDef="let row">
                    <!-- use change instead of click and emit the row -->                    
                    <mat-radio-button
                    [checked]="row.InUse"
                    [value]="row.InUse"
                    (change)="onSelectFrequency(row)">
                    </mat-radio-button>

                    <span [ngClass]="row.IsActive? '':'disable-color'" *ngIf="!row.EditMode">
                    {{row.Name}}
                    </span>

                    <div *ngIf="row.EditMode">
                    <mat-form-field>
                        <input matInput [value]="row.Name" [(ngModel)]="row.Name" name="frequency" type="text">
                    </mat-form-field>
                    </div>
                </mat-cell>
                </ng-container>

                <!-- Grace Period Days column -->
                <ng-container matColumnDef="GracePeriodDays">
                    <mat-header-cell *matHeaderCellDef>Buffer Days</mat-header-cell>
                    <mat-cell *matCellDef="let row">
                        <mat-form-field appearance="outline" style="width: 8rem;">
                            <input matInput type="number" [min]="0" [max]="15" [(ngModel)]="row.GracePeriodDays"
                                (blur)="onGraceBlur(row)" (input)="validateGrace(row)" name="grace_{{row.Index}}" inputmode="numeric"
                                step="1" aria-label="Grace Period Days" [disabled]="!isGraceEditable(row)">
                            <mat-hint align="end">{{ row.GracePeriodDays ?? 0 }}</mat-hint>
                
                            <mat-error *ngIf="row.GracePeriodDays < 0 || row.GracePeriodDays > 15">
                                Enter a value between 0 and 15
                            </mat-error>
                        </mat-form-field>
                    </mat-cell>                
                </ng-container>

                <!-- Reminder days column -->
                <ng-container matColumnDef="reminderdays">
                    <mat-header-cell *matHeaderCellDef>Reminder days</mat-header-cell>
                    <mat-cell *matCellDef="let row">
                        <mat-form-field appearance="outline" style="width: 8rem;">
                            <input matInput type="number" [min]="0" [max]="30" [(ngModel)]="row.reminderdays"
                                (input)="validateReminderdays(row)" (blur)="onReminderdaysBlur(row)" name="reminderdays_{{row.Index}}"
                                inputmode="numeric" step="1" aria-label="Reminder days" [disabled]="!isreminderdaysEditable(row)">
                            <mat-hint align="end">{{ row.reminderdays ?? 0 }}</mat-hint>

                            <mat-error *ngIf="row.reminderdays < 0 || row.reminderdays > 30">
                                Enter a value between 0 and 30
                            </mat-error>
                        </mat-form-field>
                    </mat-cell>
                </ng-container>


                <ng-container matColumnDef="Period">
                    <mat-header-cell *matHeaderCellDef>Monthly Period</mat-header-cell>
                    <mat-cell *matCellDef="let row">
                        <span [ngClass]="row.IsActive? '':'disable-color'" *ngIf="!row.EditMode">
                            {{row.Description}}
                        </span>
                        <div *ngIf="row.EditMode">
                            <mat-form-field>
                                <input matInput [value]="row.Description" [(ngModel)]="row.Description" name="period"
                                    type="number" min="1">
                                <button mat-icon-button title="Done" class="select" matSuffix
                                    (click)="approve(row, 'ReportFreq')"
                                    [disabled]="row.Name.trim().length == 0 || row.Description <= 0">
                                    <mat-icon aria-hidden="true" aria-label="done" fontIcon="done"></mat-icon>
                                </button>
                                <button mat-icon-button title="Close" class="cancel" matSuffix cdkFocusInitial
                                    (click)="reject(row)">
                                    <mat-icon aria-hidden="false" aria-label="Close" fontIcon="close"></mat-icon>
                                </button>
                            </mat-form-field>
                        </div>
                    </mat-cell>
                </ng-container>
                <ng-container matColumnDef="LastUpdatedDate">
                    <mat-header-cell *matHeaderCellDef>Last Updated Date</mat-header-cell>
                    <mat-cell *matCellDef="let row"> {{ utils.formatDate(row.LastUpdatedDate)}} </mat-cell>
                </ng-container>
                <ng-container matColumnDef="Status">
                    <mat-header-cell *matHeaderCellDef> Status Enabled/ <br>Disabled</mat-header-cell>
                    <mat-cell *matCellDef="let row">
                        <mat-slide-toggle [disabled]="flag >= 1 || row.InUse || true" [(ngModel)]="row.IsActive"
                            name="status" [checked]="row.IsActive == null? false: row.IsActive"
                            (change)="toggleStatus(row)">
                        </mat-slide-toggle> &nbsp; <span>{{(row.IsActive)? 'Enabled': 'Disabled'}}</span>
                    </mat-cell>
                </ng-container>
                <mat-header-row *matHeaderRowDef="displayedColumnsRF; sticky: true"></mat-header-row>
                <mat-row *matRowDef="let row; columns: displayedColumnsRF; let i = index"
                    [ngClass]="(i%2 == 0)? 'odd-row-bg':''"></mat-row>

            </mat-table>
            <span class="spacer"></span>

            <div class="table-header">
                <span><b>Pending Reporting Frequency Change</b></span>
            </div>

            <mat-table [dataSource]="service.masterupFreq" class="border-radius" style="min-height: 21vh;">                
                <ng-container matColumnDef="Index">
                    <mat-header-cell *matHeaderCellDef>#</mat-header-cell>
                    <mat-cell *matCellDef="let row"> {{row.Index}} </mat-cell>
                </ng-container>
                <ng-container matColumnDef="CurrentFrequency">
                    <mat-header-cell *matHeaderCellDef>Current Frequency</mat-header-cell>
                    <mat-cell *matCellDef="let row"> {{row.CurrentFrequency}} </mat-cell>
                </ng-container>    
                <ng-container matColumnDef="NewFrequency">
                    <mat-header-cell *matHeaderCellDef>New Frequency</mat-header-cell>
                    <mat-cell *matCellDef="let row"> {{row.NewFrequency}} </mat-cell>
                </ng-container>
                <ng-container matColumnDef="OldBufferDays">
                    <mat-header-cell *matHeaderCellDef>Old Buffer Days</mat-header-cell>
                    <mat-cell *matCellDef="let row"> {{row?.OldBufferDays}} </mat-cell>
                </ng-container>
                <ng-container matColumnDef="NewBufferDays">
                    <mat-header-cell *matHeaderCellDef>New Buffer Days</mat-header-cell>
                    <mat-cell *matCellDef="let row"> {{row?.NewBufferDays}} </mat-cell>
                </ng-container>  
                <ng-container matColumnDef="EffectiveDate">
                    <mat-header-cell *matHeaderCellDef>Effective Date</mat-header-cell>
                    <mat-cell *matCellDef="let row"> {{ utils.formatDate(row.EffectiveDate)}} </mat-cell>
                </ng-container>                              
                <ng-container matColumnDef="FullName">
                    <mat-header-cell *matHeaderCellDef>Updated by</mat-header-cell>
                    <mat-cell *matCellDef="let row"> {{row.FullName}} </mat-cell>
                </ng-container>    
                <mat-header-row *matHeaderRowDef="displayedColumns4; sticky: true"></mat-header-row>
                <mat-row *matRowDef="let row; columns: displayedColumns4; let i = index" [ngClass]="(i%2 == 0)? '':'odd-row-bg'"></mat-row>
                <tr *matNoDataRow><td [attr.colspan]="displayedColumns4.length"><span style="color:red; font-size: large;">No reporting frequency changes found</span></td></tr>
            </mat-table>

            <mat-dialog-actions>
                <span class="spacer"></span>
                <!-- <button mat-button mat-raised-button color="primary" (click)="submit()">Save</button>
                <button mat-button mat-dialog-close>Cancel</button> -->
                <div class="move-buttons" >
                    <button class="buttons save" id="saveRF" (click)="submitReportingFreq()" ><img src="./assets/images/icon-application.svg" alt="Save">Save</button>    
                    </div>
                            <button type="button" class="btn btn-secondary modalCancelBtn" id="cancel" style="margin-right: 1vh;height: 6vh;" (click)="close()">Cancel</button>
            </mat-dialog-actions>
        </div>
    </div>

    <div class="kri-table" *ngIf="isActive('status')">
        <div class="table-header">
            <span> <b>Status</b> </span>
            <span class="spacer"></span>
        </div>
        <div class="mat-elevation-z8 border-radius">
            <mat-table [dataSource]="service.masterStatus" class="border-radius" style="min-height: 73vh;">
                <ng-container matColumnDef="StatusIndex">
                    <mat-header-cell *matHeaderCellDef>#</mat-header-cell>
                    <mat-cell *matCellDef="let row"> {{row.Index}} </mat-cell>
                </ng-container>
                <ng-container matColumnDef="StatusName">
                    <mat-header-cell *matHeaderCellDef>Status</mat-header-cell>
                    <mat-cell *matCellDef="let row">
                        <span *ngIf="!row.EditMode">
                            {{row.Name}}
                        </span>
                    </mat-cell>
                </ng-container>
                <mat-header-row *matHeaderRowDef="displayedColumnsStatus; sticky: true"></mat-header-row>
                <mat-row *matRowDef="let row; columns: displayedColumnsStatus; let i = index"
                    [ngClass]="(i%2 == 0)? 'odd-row-bg':''"></mat-row>
            </mat-table>
        </div>
    </div>
    <div class="kri-table" *ngIf="isActive('thresholdValue')">
        <div class="table-header">
            <span> <b>Threshold Value</b> </span>
            <span class="spacer"></span>
        </div>
        <div class="mat-elevation-z8 border-radius" style="width: 74vw;">
            <mat-table [dataSource]="service.masterTV" class="border-radius" style="min-height: 73vh;">
                <ng-container matColumnDef="ThreIndex">
                    <mat-header-cell *matHeaderCellDef>#</mat-header-cell>
                    <mat-cell *matCellDef="let row"> {{row.Index}} </mat-cell>
                </ng-container>
                <ng-container matColumnDef="Value">
                    <mat-header-cell *matHeaderCellDef>Threshold Value</mat-header-cell>
                    <mat-cell *matCellDef="let row">
                        <span [ngClass]="row.IsActive? '':'disable-color'" *ngIf="!row.EditMode">
                            {{row.Value}}
                        </span>
                        <div *ngIf="row.EditMode">
                            <mat-form-field class="name-input">
                                <input matInput [value]="row.Value" [(ngModel)]="row.Value" disabled="true"
                                    (keyup)="checkDuplicate(row, 'ThresholdValue')" type="number" min="0">
                            </mat-form-field>
                        </div>
                    </mat-cell>
                </ng-container>
                <ng-container matColumnDef="ColorCode">
                    <mat-header-cell *matHeaderCellDef>Threshold Value Colour Zone
                    </mat-header-cell>
                    <mat-cell *matCellDef="let row">
                        <div [(colorPicker)]="row.ColorCode" [style.background]="row.ColorCode"
                            [cpDisabled]="!row.EditMode" (colorPickerChange)="checkDuplicate(row, 'ThresholdValue')"
                            [ngStyle]="{'opacity': (row.IsActive || row.EditMode)? '': '0.3', 'cursor': row.EditMode? 'pointer': 'context-menu' }"
                            class="color-picker-box">
                        </div>
                        <label *ngIf="!row.EditMode"
                            [ngClass]="row.IsActive? '':'disable-color'">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                            {{row.Name}}</label>
                        <div *ngIf="row.EditMode">
                            <mat-form-field class="name-input">
                                <input matInput [value]="row.Name" name="Name" [(ngModel)]="row.Name" type="text"
                                    (keyup)="checkDuplicate(row, 'ThresholdValue')">
                            </mat-form-field>
                        </div>
                    </mat-cell>
                </ng-container>
                <ng-container matColumnDef="Action">
                    <mat-header-cell *matHeaderCellDef>Action</mat-header-cell>
                    <mat-cell *matCellDef="let row">
                        <button *ngIf="!row.EditMode" mat-icon-button (click)="edit(row, 'ThresholdValue')">
                            <mat-icon aria-hidden="false" aria-label="Edit" fontIcon="edit"></mat-icon>
                        </button>
                        <mat-action-row *ngIf="row.EditMode" [matTooltip]="duplicate? 'Record already exists':''">
                            <button mat-icon-button title="Done" class="select" matSuffix
                                [disabled]="!row.Value || row.Name.trim().length == 0 || duplicate"
                                (click)="approve(row, 'ThresholdValue')">
                                <mat-icon aria-hidden="true" aria-label="done" fontIcon="done"></mat-icon>
                            </button>
                            <button mat-icon-button title="Close" class="cancel" matSuffix (click)="reject(row)">
                                <mat-icon aria-hidden="false" aria-label="Close" fontIcon="close">
                                </mat-icon>
                            </button>
                        </mat-action-row>
                    </mat-cell>
                </ng-container>
                <mat-header-row *matHeaderRowDef="displayedColumns1; sticky: true"></mat-header-row>
                <mat-row *matRowDef="let row; columns: displayedColumns1; let i = index"
                    [ngClass]="(i%2 == 0)? 'odd-row-bg':''"></mat-row>
            </mat-table>
        </div>
    </div>
    <div *ngIf="isActive('emailTrigger')">
        <div class="kri-table">
            <div class="table-header">
                <span style="font-size:large;"> <b>{{header}}</b> </span>
                <span class="spacer"></span>
            </div>
            <div class="mat-elevation-z9 border-radius" style="min-height: 63vh;">
                <mat-card class="border-radius table" style="min-height: 56vh;">
                    <div style="display: flex;margin-right: 17vh;">
                        <div style="margin-right: 1vh;">
                            <div style="font-size: large;font-weight: 600;">Email Trigger Setting</div>
                            <div style="display: flex;">
                                <div>
                                    <div class="Kri-Email">Select Month</div>
                                    <div *ngFor="let month of yearValues" style="margin-left: 5vh;margin-top: 1vh;">
                                        <mat-radio-button [value]="month" (click)="handleClick(month)" [disabled]="monthFlag" [checked]="selectedMonth == month">{{
                                            month }}</mat-radio-button>
                                        <span class="spacer"></span>
                                    </div>
                                </div>
                                <div>
                                    <div class="Kri-Email">Select Day of the Month</div>
                                    <mat-form-field appearance="fill" style="margin-left: 4vh;width: 18vh;margin-top: 2vh;">
                                        <mat-label>Select Day</mat-label>
                                        <mat-select matSelectSearch placeholder="Search day..." [(ngModel)]="filterEmailData[0].Day" (selectionChange)="onDaySelect($event)">
                                            <mat-option *ngFor="let day of days" [value]="day">{{ day }}</mat-option>
                                        </mat-select>
                                    </mat-form-field>
                                </div>
                            </div>
                            
                           
                        </div>
                        <div
                            style="margin-left: 24vh;margin-top: 3vh;margin-right: -18vh;color: #a39d9d;font-size: 15px;">
                            <p>Please select the Month of each Quarter and the Day of the respective Month when the
                                Email Trigger will get activated
                                for defaulter Units. User can send automated emails on the selected date of the selected
                                month to send reminder emails.</p>
                            <p>With this selection,"Send Reminder" button will be enabled on the selected day.</p>

                        </div>
                    </div>
                </mat-card>
                <mat-dialog-actions>
                    <span class="spacer"></span>
                    <!-- <button mat-button mat-raised-button color="primary" (click)="submit()">Save</button>
                    <button mat-button mat-dialog-close>Cancel</button> -->
                    <div class="move-buttons" >
                        <button class="buttons save" id="saveSub" (click)="submit()" ><img src="./assets/images/icon-application.svg"
                                  alt="Save">Save</button>
        
                        </div>
                                <button type="button" class="btn btn-secondary modalCancelBtn" id="cancel" style="margin-right: 1vh;height: 6vh;" mat-dialog-close>Cancel</button>
                </mat-dialog-actions>
            </div>
        </div>

        
    </div>
</div>
