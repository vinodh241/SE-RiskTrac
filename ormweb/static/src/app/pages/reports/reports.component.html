
<mat-toolbar class="fontSize">
    <span>Reports</span>
</mat-toolbar>
<div class="container">
    <div class="report-container">
        <div class="left-container">
            <mat-card class="paddingZero"
                style="background: #E3E3E3 url(./assets/rcsa/rd-left-img.png) no-repeat center bottom; height: 100%;">
                <div>
                    <!-- <div class="topDate" >
                        <span>Data Shown: </span>
                        <span *ngIf="selectedModule=='Incidents'">
                            {{startDate | date: 'dd MMM yyyy'}} - {{endDate | date: 'dd MMM yyyy'}}
                        </span>
                        <span *ngIf="selectedModule=='Risk Appetite'">
                            {{selectedStartDate | date: 'dd MMM yyyy'}} - {{selectedEndDate | date: 'dd MMM yyyy'}}
                        </span>
                        <span *ngIf="selectedModule!='Incidents' && selectedModule!='Risk Appetite'">
                            {{minStartDate | date: 'dd MMM yyyy'}} - {{maxEndDate | date: 'dd MMM yyyy'}}
                        </span>
                    </div> -->
                    <div class="dashFilter">
                        <mat-card-content class="side-card-content">
                            <div class="w50 padd1vhRight">
                                <h4 class="header-style">Year</h4>
                                <mat-form-field appearance="fill">
                                    <mat-select (selectionChange)="checkYear($event.value)" [(ngModel)]="yearFilter">
                                        <mat-option *ngFor="let year of yearsList" [value]="year">
                                            {{year}}
                                        </mat-option>
                                    </mat-select>
                                </mat-form-field>
                            </div>
                            <div class="w50 padd1vhLeft" style="margin-right: 0px;">
                                <h4 class="header-style">Quarter</h4>
                                <mat-form-field appearance="fill">
                                    <mat-select [(ngModel)]="quarterFilter"
                                        (selectionChange)="checkMonth($event.value)">
                                        <mat-option *ngFor="let quarter of quartersList" [value]="quarter">
                                            {{quarter}}
                                        </mat-option>
                                    </mat-select>
                                </mat-form-field>
                            </div>
                        </mat-card-content>
                    </div>
                    <div class="top-padding">
                        <mat-card-content class="side-card-content">
                            <h5>Select Module</h5>
                            <mat-radio-group [(ngModel)]="selectedModule" class="radio-group">
                                <mat-radio-button *ngFor="let module of modules" [value]="module"
                                    [checked]="selectedModule == module">
                                    {{module}}
                                </mat-radio-button>
                            </mat-radio-group>
                            <div *ngIf="selectedModule=='Incidents'">
                                <h5>Incident Date Range</h5>
                                <mat-form-field appearance="fill" style="width: 28vh;">
                                    <mat-date-range-input [rangePicker]="picker" [min]="minStartDate"
                                        [max]="maxEndDate">
                                        <input matStartDate placeholder="Start date" readonly [(ngModel)]="startDate"
                                            [value]="minStartDate">
                                        <input matEndDate placeholder="End date" readonly [(ngModel)]="endDate"
                                            [value]="maxEndDate">
                                    </mat-date-range-input>
                                    <mat-datepicker-toggle matIconSuffix [for]="picker" style="margin-top: -2vh !important;">
                                    </mat-datepicker-toggle>
                                    <mat-date-range-picker #picker></mat-date-range-picker>

                                </mat-form-field>
                                <h5>Criticality</h5>
                                <mat-form-field appearance="fill">
                                    <mat-select [(ngModel)]="selectedCriticality">
                                        <mat-option [value]="'All'">All</mat-option>
                                        <mat-option *ngFor="let item of incidentValues?.criticality" [value]="item">
                                            {{item}}
                                        </mat-option>
                                    </mat-select>
                                </mat-form-field>
                                <h5>Incident Status</h5>
                                <mat-form-field appearance="fill">
                                    <mat-select [(ngModel)]="selectedIncidentStatus">
                                        <mat-option [value]="'All'">All</mat-option>
                                        <mat-option *ngFor="let item of incidentValues?.incidentStatus" [value]="item">
                                            {{item}}
                                        </mat-option>
                                    </mat-select>
                                </mat-form-field>
                                <h5>Incident Unit</h5>
                                <mat-form-field appearance="fill">
                                    <mat-select [(ngModel)]="selectedUnit">
                                        <mat-option [value]="'All'">All</mat-option>
                                        <mat-option *ngFor="let item of incidentUnitData" [value]="item">
                                            {{item}}
                                        </mat-option>
                                    </mat-select>
                                </mat-form-field>
                            </div>
                            <!-- KRI LEFT SIDE  -->
                            <div *ngIf="selectedModule=='KRI'">
                                <!-- <h5>Measurement Frequency</h5>
                                <mat-form-field appearance="fill">
                                    <mat-select [(ngModel)]="selectedMeasureFreq">
                                        <mat-option [value]="'All'">All</mat-option>
                                        <mat-option *ngFor="let item of KRIValues?.measurementFreq" [value]="item">
                                            {{item}}
                                        </mat-option>
                                    </mat-select>
                                </mat-form-field> -->                                
                                <h5>Month</h5>
                                <mat-form-field appearance="fill">
                                <mat-select [(ngModel)]="selectedMonth" (selectionChange)="onMonthChange($event.value)">
                                    <mat-option *ngFor="let m of monthsList" [value]="m.period">
                                    {{ m.name }}   <!-- only month name shown -->
                                    </mat-option>
                                </mat-select>
                                </mat-form-field>
                                                            
                                <h5>KRI Type</h5>
                                <mat-form-field appearance="fill">
                                    <mat-select [(ngModel)]="selectedKriType">
                                        <mat-option [value]="'All'">All</mat-option>
                                        <mat-option *ngFor="let item of KRIValues?.KriType" [value]="item">
                                            {{item}}
                                        </mat-option>
                                    </mat-select>
                                </mat-form-field>

                                <h5>KRI Value</h5>
                                <mat-form-field appearance="fill">
                                    <mat-select [(ngModel)]="selectedKriValue">
                                        <mat-option [value]="'All'">All</mat-option>
                                        <mat-option [value]="'1'">1</mat-option>
                                        <mat-option [value]="'2'">2</mat-option>
                                        <mat-option [value]="'3'">3</mat-option>
                                        <mat-option [value]="'4'">4</mat-option>
                                        <mat-option [value]="'5'">5</mat-option>
                                        <!-- <mat-option *ngFor="let item of KRIValues?.KriValue" [value]="item">
                                        {{item}}
                                    </mat-option> -->
                                    </mat-select>
                                </mat-form-field>

                                <h5>Status</h5>
                                <mat-form-field appearance="fill">
                                    <mat-select [(ngModel)]="selectedKriStatus">
                                        <mat-option [value]="'All'">All</mat-option>
                                        <mat-option *ngFor="let item of KRIValues?.KriStatus" [value]="item">
                                            {{item}}
                                        </mat-option>
                                    </mat-select>
                                </mat-form-field>
                            </div>
                            <!-- RA LEFT SIDE  -->
                            <div *ngIf="selectedModule=='Risk Appetite'">
                                <h5>Start Date</h5>
                                <mat-form-field appearance="fill" >
                                    <input matInput [matDatepicker]="startDate" readonly [ngModel]="minStartDate"
                                        (dateChange)="updateSelecedStartDate($event)" [min]="minStartDate"
                                        [max]="maxEndDate" style="margin-bottom: auto;">
                                    <mat-datepicker-toggle matIconSuffix [for]="startDate" style="margin-top: -14px;"></mat-datepicker-toggle>
                                    <mat-datepicker #startDate style="margin-top: -14px;"></mat-datepicker>
                                </mat-form-field>
                                <h5>End Date</h5>
                                <mat-form-field appearance="fill">
                                    <input matInput [matDatepicker]="endDate" readonly [ngModel]="maxEndDate"
                                        (dateChange)="updateSelecedendDate($event)" [min]="minStartDate"
                                        [max]="maxEndDate" style="margin-bottom: auto;">
                                    <mat-datepicker-toggle matIconSuffix [for]="endDate" style="margin-top: -14px;"></mat-datepicker-toggle>
                                    <mat-datepicker #endDate style="margin-top: -14px;"></mat-datepicker>
                                </mat-form-field>
                                <h5>Units</h5>
                                <mat-form-field appearance="fill">
                                    <mat-select [(ngModel)]="selectedAssesmentUnits">
                                        <mat-option [value]="'All'">All</mat-option>
                                        <mat-option *ngFor="let item of raUnitData" [value]="item">
                                            {{item}}
                                        </mat-option>
                                    </mat-select>
                                </mat-form-field>
                                <h5>Status</h5>
                                <mat-form-field appearance="fill">
                                    <mat-select [(ngModel)]="selectedStatus">
                                        <mat-option [value]="'All'">All</mat-option>
                                        <mat-option *ngFor="let item of assessmentStatus" [value]="item">
                                            {{item}}
                                        </mat-option>
                                    </mat-select>
                                </mat-form-field>
                            </div>
                            <!-- RCSA LEFT SIDE  -->
                            <div *ngIf="selectedModule=='RCSA'">
                                <h5>Unit</h5>
                                <mat-form-field appearance="fill">
                                    <mat-select [(ngModel)]="selectedRCSUnit">
                                        <mat-option [value]="'All'">All</mat-option>
                                        <mat-option *ngFor="let item of rcsaUnitData" [value]="item">
                                            {{item}}
                                        </mat-option>
                                    </mat-select>
                                </mat-form-field>
                                <h5>Status</h5>
                                <mat-form-field appearance="fill">
                                    <mat-select [(ngModel)]="selectedRCSStatus">
                                        <mat-option [value]="'All'">All</mat-option>
                                        <mat-option *ngFor="let item of RCSValues?.status" [value]="item">
                                            {{item}}
                                        </mat-option>
                                    </mat-select>
                                </mat-form-field>
                                <h5>Inherent Risk Rating</h5>
                                <mat-form-field appearance="fill">
                                    <mat-select [(ngModel)]="selectedInherentRating">
                                        <mat-option [value]="'All'">All</mat-option>
                                        <mat-option *ngFor="let item of RCSValues?.inherentRating" [value]="item">
                                            {{item}}
                                        </mat-option>
                                    </mat-select>
                                </mat-form-field>
                                <h5>Residual Risk Rating</h5>
                                <mat-form-field appearance="fill">
                                    <mat-select [(ngModel)]="selectedResidualRating">
                                        <mat-option [value]="'All'">All</mat-option>
                                        <mat-option *ngFor="let item of RCSValues?.residualRating" [value]="item">
                                            {{item}}
                                        </mat-option>
                                    </mat-select>
                                </mat-form-field>
                            </div>
                        </mat-card-content>
                    </div>
                </div>
            </mat-card>
        </div>
        <div class="right-container">
            <app-risk-appetite *ngIf="selectedModule=='Risk Appetite'" [selectedStartDate]="selectedStartDate"
                [selectedEndDate]="selectedEndDate" [selectedStatus]="selectedStatus" [selectedUnits]="selectedUnits"
                [selectedUnits]="selectedAssesmentUnits" [yearValue]="yearFilter" [quarterValue]="quarterFilter">
            </app-risk-appetite>
            <app-report-incident *ngIf="selectedModule=='Incidents'" [startDate]="startDate" [endDate]="endDate"
                [selectedCriticality]="selectedCriticality" [selectedIncidentStatus]="selectedIncidentStatus"
                [selectedUnit]="selectedUnit" [yearValue]="yearFilter" [quarterValue]="quarterFilter">
            </app-report-incident>
            <app-report-kri *ngIf="selectedModule=='KRI'" [selectedMeasureFreq]="selectedMeasureFreq"
                [presentQuarter]="quarter" [selectedKriType]="selectedKriType" [selectedKriValue]="selectedKriValue"
                [selectedKriStatus]="selectedKriStatus" [yearValue]="yearFilter" [quarterValue]="quarterFilter"
                [quarterNumber]="presentQuater" [qStartDate]="minStartDate" [qEndDate]="maxEndDate"
                [selectedMonth]="selectedMonth"></app-report-kri>
            <app-report-rcsa *ngIf="selectedModule=='RCSA'" [selectedRCSUnit]="selectedRCSUnit"
                [selectedRCSStatus]="selectedRCSStatus" [selectedInherentRating]="selectedInherentRating"
                [selectedResidualRating]="selectedResidualRating" [yearValue]="yearFilter"
                [quarterValue]="quarterFilter"></app-report-rcsa>
        </div>
    </div>
</div>
